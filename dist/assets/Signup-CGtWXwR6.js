import{c as g,u as q,r,j as e,m as C,A as R}from"./index-C4Srh_oV.js";import{s as W}from"./profileUtils-CQMFgpeE.js";import{S as B}from"./shield-check-Dqd6tyHl.js";import{C as J}from"./circle-check-C9zYruw1.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=g("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=g("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=g("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=g("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=g("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),E=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i,I=/^\+[1-9]\d{6,14}$/;function Q(m){let n=0;return m.length>=8&&n++,/[A-Z]/.test(m)&&n++,/[a-z]/.test(m)&&n++,/\d/.test(m)&&n++,/[^\w\s]/.test(m)&&n++,Math.min(n,4)}function le(){const{signup:m,loginWithGithub:n,loginWithGoogle:F}=q(),[p,T]=r.useState(""),[x,L]=r.useState(""),[o,A]=r.useState(""),[f,H]=r.useState(""),[b,_]=r.useState(""),[j,G]=r.useState(!1),[w,v]=r.useState([{name:"",email:"",mobile:""},{name:"",email:"",mobile:""}]),[N,S]=r.useState(!1),[O,k]=r.useState(!1),[M,s]=r.useState(null),[X,P]=r.useState(!1),y=r.useMemo(()=>Q(b),[b]),z=["Too short","Weak","Okay","Strong","Very strong"];async function Y(a){var h,d,c;if(a.preventDefault(),s(null),!p&&!x)return s("Please add your name or a username.");if(!E.test(o))return s("Please enter a valid email address.");if(f&&!I.test(f))return s("Mobile should be E.164 format, e.g., +91XXXXXXXXXX.");for(const t of w)if(!(!t.name&&!t.email&&!t.mobile)){if(t.email&&!E.test(t.email))return s("Loved-one email looks invalid.");if(t.mobile&&!I.test(t.mobile))return s("Loved-one mobile must be E.164 format (e.g., +91•••).")}if(y<2)return s("Please choose a stronger password (8+ chars incl. upper/lower/digit/symbol).");if(!N)return s("Please agree to the Terms & Consent to continue.");try{P(!0);const t=w.filter(l=>l.name||l.email||l.mobile).map(l=>({name:l.name||"",email:l.email||"",whatsapp:l.mobile||""})),i=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,password:b,name:p||x||o,lovedOnes:t})});if(!i.ok){const l=await i.json().catch(()=>({}));throw new Error(l.error||"Signup failed")}const u=await i.json();localStorage.setItem("mindmate_user_token",u.token),localStorage.setItem("mindmate_user",JSON.stringify(u.user));const $={name:p||x||((h=u.user)==null?void 0:h.name)||"",username:x||u.user&&(u.user.username||""),email:((d=u.user)==null?void 0:d.email)||o,phone:f||"",bio:"",image:"",parentalContact:t.map(l=>({name:l.name,email:l.email,phone:l.whatsapp||""})),instagram:"",facebook:""};W(((c=u.user)==null?void 0:c.email)||o,$),window.location.href="/dashboard"}catch(t){s((t==null?void 0:t.message)||"Signup failed. Please try again.");try{await m(o,b,p||x||o)}catch{}}finally{P(!1)}}return e.jsxs("div",{className:"relative max-w-3xl mx-auto",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 -z-10 bg-[radial-gradient(60rem_40rem_at_120%-10%,theme(colors.indigo.300/15),transparent),radial-gradient(60rem_40rem_at-10%_0%,theme(colors.cyan.300/12),transparent)]"}),e.jsxs(C.section,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.35},className:"card rounded-2xl border border-slate-200/60 dark:border-slate-800/60 bg-white/70 dark:bg-slate-900/60 backdrop-blur p-6",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("span",{className:"inline-flex h-9 w-9 items-center justify-center rounded-xl bg-gradient-to-tr from-indigo-500 to-cyan-500 text-white shadow",children:e.jsx(B,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight",children:"Create your account"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Private by default • You control sharing and alerts"})]})]}),e.jsxs("form",{onSubmit:Y,className:"space-y-5",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium",htmlFor:"full-name",children:"Full name"}),e.jsx("input",{id:"full-name",className:"mt-1 w-full border rounded-xl px-3 py-2 bg-white/70 dark:bg-slate-900/50",placeholder:"e.g., Aisha Khan",value:p,onChange:a=>T(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium",htmlFor:"username",children:"Preferred username"}),e.jsx("input",{id:"username",className:"mt-1 w-full border rounded-xl px-3 py-2 bg-white/70 dark:bg-slate-900/50",placeholder:"e.g., aisha",value:x,onChange:a=>L(a.target.value)})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium",htmlFor:"email",children:"Email"}),e.jsx("input",{id:"email",className:"mt-1 w-full border rounded-xl px-3 py-2 bg-white/70 dark:bg-slate-900/50",placeholder:"you@example.com",value:o,onChange:a=>A(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium",htmlFor:"mobile",children:"Mobile (E.164)"}),e.jsx("input",{id:"mobile",className:"mt-1 w-full border rounded-xl px-3 py-2 bg-white/70 dark:bg-slate-900/50",placeholder:"+91XXXXXXXXXX",value:f,onChange:a=>H(a.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium",htmlFor:"pw",children:"Password"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{id:"pw",type:j?"text":"password",className:"w-full border rounded-xl pl-3 pr-10 py-2 bg-white/70 dark:bg-slate-900/50",placeholder:"8+ chars with mix of types",value:b,onChange:a=>_(a.target.value)}),e.jsx("button",{type:"button",className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded-md hover:bg-slate-900/5 dark:hover:bg-white/5",onClick:()=>G(a=>!a),"aria-label":j?"Hide password":"Show password",children:j?e.jsx(V,{className:"h-4 w-4"}):e.jsx(Z,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"mt-2 h-1.5 rounded-full bg-slate-200 dark:bg-slate-800 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${y>=1?"bg-rose-500":""}`,style:{width:`${Math.max(8,y*25)}%`}})}),e.jsx("p",{className:"mt-1 text-[11px] text-slate-500 dark:text-slate-400",children:z[y]})]}),e.jsxs("div",{className:"rounded-2xl border border-slate-200/60 dark:border-slate-800/60 p-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Loved-one contacts (Parental/Loved-one)"}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 mb-3",children:"Add up to two trusted recipients for summaries and urgent alerts (with your consent)."}),e.jsx("div",{className:"grid md:grid-cols-2 gap-3",children:w.map((a,h)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{className:"w-full border rounded-xl px-3 py-2 bg-white/70 dark:bg-slate-900/50",placeholder:"Name",value:a.name,onChange:d=>v(c=>c.map((t,i)=>i===h?{...t,name:d.target.value}:t))}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2 bg-white/70 dark:bg-slate-900/50",placeholder:"Email",value:a.email,onChange:d=>v(c=>c.map((t,i)=>i===h?{...t,email:d.target.value}:t))}),e.jsx("input",{className:"w-full border rounded-xl px-3 py-2 bg-white/70 dark:bg-slate-900/50",placeholder:"Mobile (+91•••)",value:a.mobile,onChange:d=>v(c=>c.map((t,i)=>i===h?{...t,mobile:d.target.value}:t))})]},h))}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-2",children:"By default, summaries are prepared for you to review. Nothing is sent automatically without explicit opt-in and verification."})]}),e.jsxs("label",{className:"flex items-start gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:a=>S(a.target.checked),className:"mt-1"}),e.jsxs("span",{children:["I agree to the ",e.jsx("button",{type:"button",className:"underline",onClick:()=>k(!0),children:"Terms & Consent"})," and understand this is a wellness demo, not a medical device. For emergencies in India, call ",e.jsx("b",{children:"112"}),"."]})]}),M&&e.jsxs("p",{className:"text-red-600 text-sm flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"})," ",M]}),e.jsx("button",{className:"w-full btn btn-primary inline-flex items-center justify-center gap-2",disabled:!N||X,children:X?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4 animate-spin"})," Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4"})," Create account"]})})]}),e.jsxs("div",{className:"my-4 flex items-center gap-3",children:[e.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-800 flex-1"}),e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:"or"}),e.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-800 flex-1"})]}),e.jsx("button",{onClick:async()=>{s(null);try{await n()}catch(a){s(a.message||"GitHub sign-in failed")}},className:"w-full px-3 py-2 rounded-xl border btn-outline mb-2",children:"Continue with GitHub"}),e.jsx("button",{onClick:async()=>{s(null);try{await F()}catch(a){s(a.message||"Google sign-in failed")}},className:"w-full px-3 py-2 rounded-xl border btn-outline",children:"Continue with Google"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-4",children:"You can create an account with email above or continue with GitHub/Google (via Firebase). This is a demo — not a medical device."})]}),e.jsx(R,{children:O&&e.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-black/40 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs(C.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.2},className:"max-w-3xl w-full rounded-2xl border border-slate-200/60 dark:border-slate-800/60 bg-white/90 dark:bg-slate-900/90 backdrop-blur p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(D,{className:"h-5 w-5"}),e.jsx("h3",{className:"font-semibold",children:"Terms & Consent"})]}),e.jsxs("div",{className:"prose prose-sm dark:prose-invert max-h-[60vh] overflow-y-auto",children:[e.jsxs("p",{children:[e.jsx("b",{children:"Purpose."})," MindMate is an educational wellness demo that offers self-help content and mood tracking. It does not provide clinical diagnosis or treatment."]}),e.jsxs("p",{children:[e.jsx("b",{children:"Privacy."})," Your profile data stays private by default. You control if, when, and what to share with loved ones."]}),e.jsxs("p",{children:[e.jsx("b",{children:"Loved-one summaries."})," If you enable summaries, drafts will be prepared. No automated sending occurs without explicit opt-in."]}),e.jsxs("p",{children:[e.jsx("b",{children:"Crisis."})," If you indicate distress the app surfaces quick options (dial 112 in India) and saved contacts. The app will not contact anyone automatically."]}),e.jsxs("p",{children:[e.jsx("b",{children:"Acceptance."})," By checking “I agree”, you consent to these terms."]})]}),e.jsxs("div",{className:"mt-3 flex justify-end gap-2",children:[e.jsx("button",{className:"btn btn-outline",onClick:()=>k(!1),children:"Close"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{S(!0),k(!1)},children:"I agree"})]})]})})})]})}export{le as default};
